char add=0,minus=0,CharacterN=0,Character2N=3;
_Bool Direction=0;
void CollisionTestTwo(void);
void DrawSM(unsigned short int x, unsigned short int y, unsigned char SMn, _Bool ForBack, char ClearSM);
void DrawBrick(unsigned short int x, unsigned short int y, unsigned char brick);
unsigned char ReadTouch2(unsigned short int ypos, unsigned short int xpos);
void DrawNuvola(unsigned char x, unsigned short int y);
unsigned char ReadRfModule(void);

unsigned char Nuvola[768]=
{
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0x00,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0x03,0x03,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,0x00,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0x00,0xff,0x00,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0xff,0x00,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0x00,0xaa,
	0xaa,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0x00,
	0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,
	0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,
	0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,
	0xaa,0xaa,0x00,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,0xaa,
	0xaa,0xaa,0xaa,0x00,0xff,0xff,0x03,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xaa,
	0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,
	0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0x03,0x03,0x03,0x03,0x03,0x03,0xff,0x03,0x03,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0x03,0x03,0xff,0xff,0xff,0xff,0x03,0x03,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x00,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0xff,0x00,0x00,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0xff,0xff,0xff,0x00,0xaa,0x00,0x00,0xff,0xff,0xff,0xff,0x00,0x00,0xaa,0x00,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,
	0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0x00,0xaa,0xaa,0xaa,0xaa,0x00,0x00,0x00,0x00,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
};

unsigned char Cubix[10][256]=
{
	{
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
        0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
        0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x24,0x24,0x24,
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
	},//Mattone	
	{
		0xaa,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0xaa,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0x00,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0x24,0x24,0x24,0x24,0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0x24,0x24,0x00,0x00,0x00,0x24,0x24,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0x00,0x00,0xfe,0x24,0x24,0x24,0x00,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x24,0x24,0x00,0x00,0x00,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,0x00,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x24,0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x24,0x24,0x00,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x24,0xfe,0x00,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,0x00,0xfe,0xfe,0xfe,0x00,0xfe,0x00,
        0x24,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0xfe,0x00,
        0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
	},//Bonus
	{
		0xaa,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xaa,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
        0x00,0x24,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x00,
        0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
         0xaa,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xaa
	},//Bonus empty
	{
		0x24,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x24,0xff,0xff,0xff,0xff,0x24,
        0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x00,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x24,0x00,0x00,0x00,0x00,0x24,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0xff,0xff,0xff,0xff,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x00,
            0x00,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x24,0x00,
            0xff,0xff,0x00,0x00,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0xff,0xff,0x00,0x00,0x00,0x00,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0xff,0xff,0xff,0x00,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x00,
            0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0xff,0x24,0x24,0x24,0x24,0x24,0x00,0x00,
            0x24,0x00,0x00,0x00,0x00,0x00,0x00,0x24,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x24
		},//ground
		{
			0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
            0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,0xaa,
		},//Bonus hide
		{
			0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
            0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,
		},//clear screen 16x16
		{
			0xaa,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0xaa,0x00,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,
            0xaa,0x00,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x1c,0x1c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,0x1c,
            0xaa,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0xaa,0xaa,0xaa,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		},//pipe up-sx
		{
			0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xaa,
            0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xaa,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xaa,0xaa,0xaa,
		},//pipe up-dx
		{
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
			0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            0xaa,0xaa,0xaa,0x00,0x0c,0x0c,0x0c,0x1c,0x1c,0x0c,0x0c,0x0c,0x0c,0x1c,0x0c,0x0c,
            
		},//pipe down-sx
		{
			0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
            0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x1c,0x0c,0x1c,0x0c,0x0c,0x00,0xaa,0xaa,0xaa,
		},//pipe down-dx
	};
	
unsigned char Character[5][256]=
{
	{
		0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,
        0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0xe3,0xe3,0x00,0xe3,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,0xff,
        0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,
        0xff,0xff,0xff,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0x00,0x00,0xff,0xff,
        0xff,0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0x03,0xe0,0xe3,0xe3,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xe3,0xe3,0xe0,0xe0,0xe0,0xe0,0xe0,0xe3,0xe3,0xe3,0xff,0xff,0xff,
        0xff,0xff,0xe3,0xe3,0xe3,0x03,0xe0,0xe0,0xe0,0xe0,0xe3,0xe3,0xff,0xff,0xff,0xff,
        0xff,0xff,0xe0,0xe0,0xe0,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0xff,
        0xff,0xff,0xe0,0xe0,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0xff,
        0xff,0xe0,0xe0,0xe0,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xff,0xff,0xff,0xff,0xff,
        0xff,0xe0,0xe0,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
	},///Movimento cammina
    {
		0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,
        0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0xe3,0xe3,0x00,0xe3,0xff,0xff,0xff,0xff,
        0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,0xff,
        0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,
        0xff,0xff,0xff,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0x00,0x00,0xff,0xff,
        0xff,0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,
        0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0x03,0x03,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
        0xe3,0xe3,0xe3,0xe0,0xe0,0xe0,0xe0,0x03,0x03,0x03,0xe0,0xe0,0xe0,0xe3,0xe3,0xe3,
        0xe3,0xe3,0xe3,0xe3,0xe0,0xe0,0xe0,0x03,0xae,0x03,0x03,0x03,0xe0,0xe0,0xe3,0xe3,
        0xe3,0xe3,0xe3,0xff,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xe0,0xe0,0xff,
        0xff,0xff,0xff,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xe0,0xe0,0xff,
        0xff,0xff,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0xe0,0xe0,0xff,
        0xff,0xe0,0xe0,0xe0,0x03,0x03,0x03,0xff,0xff,0x03,0x03,0x03,0x03,0xe0,0xe0,0xff,
        0xff,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
        0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
	},///Moviento salto

                 ///Movimento fermo
                {
                 0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,
                 0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0xe3,0xe3,0x00,0xe3,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,0xff,
                 0xff,0xff,0xff,0x24,0x24,0xe3,0x24,0x24,0xe3,0xe3,0xe3,0x00,0xe3,0xe3,0xe3,0xff,
                 0xff,0xff,0xff,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0x00,0x00,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0x03,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0x03,0x03,0xe0,0xe0,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0x03,0x03,0xfc,0x03,0x03,0xfc,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0x03,0x03,0x03,0x03,0x03,0xff,0xff,0xff,
                 0xff,0xff,0xff,0x03,0x03,0xe0,0xe0,0xe3,0xe3,0xe3,0x03,0x03,0x03,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0x03,0x03,0xe0,0xe3,0xe3,0x03,0x03,0x03,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0x03,0x03,0x03,0x03,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0xe0,0xe0,0xe0,0xe0,0xe0,0xff,0xff,0xff,0xff,0xff,0xff,},

                 ///Personaggio 2
				{
                 0xff,0xff,0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,
                 0xff,0xff,0x24,0x00,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x00,0x24,0xff,0xff,
                 0xff,0x24,0x24,0x24,0xe3,0x00,0x24,0x24,0x24,0x24,0x00,0xe3,0x24,0x24,0x24,0xff,
                 0xff,0x24,0x24,0x24,0xe3,0x00,0x00,0x00,0x00,0x00,0x00,0xe3,0x24,0x24,0x24,0xff,
                 0x24,0x24,0x24,0x24,0xe3,0x00,0xe3,0x03,0xe0,0xe3,0x00,0xe3,0x24,0x24,0x24,0x24,
                 0x24,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe0,0x03,0xe3,0xe3,0xe3,0x24,0x24,0x24,0x24,
                 0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,
                 0xff,0x24,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0x24,0x24,0x24,0x24,0xff,
                 0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0xff,0xff,
                 0xff,0xff,0xff,0x00,0x00,0xe3,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0x00,0x00,0x00,0xff,
                 0xff,0xff,0xff,0x00,0x00,0x00,0xe3,0xe3,0xe3,0x00,0x00,0x00,0x00,0x00,0x00,0xff,
                 0xff,0xff,0xff,0xff,0x00,0x00,0x00,0xe3,0xff,0x00,0x00,0x00,0x00,0x00,0xff,0xff,},

                 //Personaggio 2 , secondo movimento
				{
                 0xff,0xff,0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,0xff,
                 0xff,0xff,0xff,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0xff,0xff,0xff,
                 0xff,0xff,0x24,0x00,0x00,0x24,0x24,0x24,0x24,0x24,0x24,0x00,0x00,0x24,0xff,0xff,
                 0xff,0x24,0x24,0x24,0xe3,0x00,0x24,0x24,0x24,0x24,0x00,0xe3,0x24,0x24,0x24,0xff,
                 0xff,0x24,0x24,0x24,0xe3,0x00,0x00,0x00,0x00,0x00,0x00,0xe3,0x24,0x24,0x24,0xff,
                 0x24,0x24,0x24,0x24,0xe3,0x00,0xe3,0x03,0xe0,0xe3,0x00,0xe3,0x24,0x24,0x24,0x24,
                 0x24,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe0,0x03,0xe3,0xe3,0xe3,0x24,0x24,0x24,0x24,
                 0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,0x24,
                 0xff,0x24,0x24,0x24,0x24,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0x24,0x24,0x24,0x24,0xff,
                 0xff,0xff,0xff,0xff,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,0xff,
                 0xff,0xff,0x00,0x00,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xe3,0xff,0xff,0xff,0xff,
                 0xff,0x00,0x00,0x00,0x00,0x00,0xe3,0xe3,0xe3,0xe3,0xe3,0x00,0x00,0xff,0xff,0xff,
                 0xff,0x00,0x00,0x00,0x00,0x00,0x00,0xe3,0xe3,0xe3,0x00,0x00,0x00,0xff,0xff,0xff,
                 0xff,0xff,0x00,0x00,0x00,0x00,0x00,0xff,0xe3,0x00,0x00,0x00,0xff,0xff,0xff,0xff,}
};

unsigned char PackState=0,ChkSumLed=0;
void CollisionTestTwo(void)
{
    char TypeBrick[14][20]=
	{
		{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,2,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,2,0,0,0,2,1,1,1,1,2,0,0,0,0,2,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3},
        {4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
        {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}
    };
    
    char inc=4,a=0;
    _Bool DisableMov[4]={0,0,0,0};
    _Bool DisableMovUp[5]={0,0,0,1};
    _Bool DisableMovDown[5]={0,0,0,1};
    _Bool DisableMovLeft[5]={0,0,0,1};
    _Bool DisableMovRight[5]={0,0,0,1};
    
    unsigned short int cuby[3]={40,80,144};
    unsigned short int cubx[3]={160,120,72};
    unsigned short int CubYOld[3]={40,80,144};
    unsigned short int CubXOld[3]={160,120,72};

    unsigned short int w=16,h=16;
    signed short int dx,dy,wy,hx,Gravity=2;
    signed short int VelocityY[3]={0,0,0};
    signed short int VelocityX[3]={0,1,2};

    signed short int yload[15]={0,16,32,48,64,80,96,112,128,144,160,176,192,208,224};
    signed short int xload[20]={0,16,32,48,64,80,96,112,128,144,160,176,192,208,224,240,256,272,288,304};
    
    signed short int xfix[80]={8,24,40,56,72,88,104,120,136,152,168,184,200,120,16,0,304};
    signed short int yfix[80]={144,160,160,160,160,160,160,160,160,160,160,160,144,112,16,0,224};

    _Bool OverLap=0;
    char TextBuffer[30];
    _Bool DrawDx=0, DrawSx=1, DrawJump=1;
    char TouchReturned=0;
    char ActiveChar[3]={1,1,1};
    char DeadTime=0,Life=0,Bonus=0;
    char bricktype[280];
    char Ba=0,Bb=0;
    const char smapp[] = {'\\',0x00,'a',0x00,'p',0x00,'p',0x00,'\0',0x00};
    char Leveln[] = {'l',0x00,'e',0x00,'v',0x00,'e',0x00,'l',0x00,'1',0x00,'.',0x00,'t',0x00,'x',0x00,'t',0x00,'\0',0x00};
    char LevelBuffer[70];
    char BufCount=0;
    FSFILE * Punta;
    unsigned char o,p=255,Level=0x31;

    unsigned short int Rota90X,Rota90Y,Rota90T;
    add=1;

    ////Prototipo RFModule
    MRF49XA_Init();
     InitRFData(&rfData);
     PacketReady=0;
    ResetRadio=0;
   
    DelayMs(200);
    
    SMStart:
	
	LCD_CLS(AZZURRO);
    //LCD_FastRect(5,120,25,140,BLUE);
    //LCD_FastRect(5,145,25,165,BLUE);
    //LCD_FastRect(5,170,25,190,BLUE);
    //LCD_FastRect(30,145,50,165,BLUE);

    LCD_FastRect(0,0,15,319,BLACK);
    sprintf(TextBuffer,"Esci");
    LCD_Text57Land(13,270,TextBuffer,2,WHITE,NONE);
    //LCD_FastRect(48,0,239,319,AZZURRO);
    o=0;

    for(i=0; i<14; i++)
    {
        for(a=0; a<20; a++)
        {
            if(TypeBrick[i][a]!=0) {xfix[o]=xload[a]; yfix[o]=yload[i]; bricktype[o]=TypeBrick[i][a]; o++;}
        }
    }
    //o=o-1;
    
    for(a=0; a<o; a++)
    {
        Rota90T=xfix[a];
        Rota90X=yfix[a];
        Rota90Y=Rota90T;
        Rota90X=239-Rota90X;

        DrawBrick(Rota90X,Rota90Y,bricktype[a]);
        //LCD_Rect(Rota90X-15,Rota90Y,Rota90X,Rota90Y+15,0,RED);
    }
    
    DrawNuvola(210,10);
    DrawNuvola(220,200);

    sprintf(TextBuffer,"Level: %c",Level);
    LCD_Text57Land(230,5,TextBuffer,1,BLACK,NONE);
    /*
    LCD_Rect(xfix[0],yfix[0],xfix[0]+15,yfix[0]+15,0,RED);
    LCD_Rect(xfix[1],yfix[1],xfix[1]+15,yfix[1]+15,0,GREEN);
    LCD_Rect(xfix[2],yfix[2],xfix[2]+15,yfix[2]+15,0,RED);
    LCD_Rect(xfix[3],yfix[3],xfix[3]+15,yfix[3]+15,0,GREEN);
    LCD_Rect(xfix[4],yfix[4],xfix[4]+15,yfix[4]+15,0,RED);
    LCD_Rect(xfix[5],yfix[5],xfix[5]+15,yfix[5]+15,0,GREEN);
    LCD_Rect(xfix[6],yfix[6],xfix[6]+15,yfix[6]+15,0,RED);
    LCD_Rect(xfix[7],yfix[7],xfix[7]+15,yfix[7]+15,0,GREEN);
    LCD_Rect(xfix[8],yfix[8],xfix[8]+15,yfix[8]+15,0,RED);
    LCD_Rect(xfix[9],yfix[9],xfix[9]+15,yfix[9]+15,0,GREEN);
    LCD_Rect(xfix[10],yfix[10],xfix[10]+15,yfix[10]+15,0,GREEN);
    LCD_Rect(xfix[11],yfix[11],xfix[11]+15,yfix[11]+15,0,RED);
    LCD_Rect(xfix[12],yfix[12],xfix[12]+15,yfix[12]+15,0,RED);
    LCD_Rect(xfix[13],yfix[13],xfix[13]+15,yfix[13]+15,0,GREEN);
*/

    //LCD_FastRect(60,285,80,305,BLUE);//left
    //LCD_FastRect(85,285,105,305,GREEN);//Down
    //LCD_FastRect(110,285,130,305,RED);//right
    //LCD_FastRect(85,260,105,280,PURPLE);//up

    

    while(TRUE)
    {
        //if(PORTDbits.RD3==0) break;
        //DrawSM(cubx[0],cuby[0],CharacterN,Direction,1);
        //LCD_Rect(cubx[0],cuby[0],cubx[0]+15,cuby[0]+15,1,WHITE);
        //LCD_Rect(cubx[1],cuby[1],cubx[1]+15,cuby[1]+15,1,WHITE);
        //LCD_Rect(cubx[2],cuby[2],cubx[2]+15,cuby[2]+15,1,WHITE);

        //if(PORTDbits.RD11==0)
        //{//se UP
            //if(DisableMov[0]==0) cuby-=inc;
        //}

        //Character 1 (quello controllato dall'user)
        if(DisableMov[3]==0)
        {//se non in collisione sopra(in salto o caduta libera)
            VelocityY[0] += Gravity;
            if(VelocityY[0]>=14) VelocityY[0]=14;
            cuby[0]+=VelocityY[0];
            DrawJump=1;///stampa il salto..
		}

        ///Character 2
        if(ActiveChar[1]==1)
        {
            if(DisableMovDown[1]==0)
            {//se non in collisione sopra(in salto o caduta libera)
                VelocityY[1] += Gravity;
                if(VelocityY[1]>=14) VelocityY[1]=14;
                cuby[1]+=VelocityY[1];
            }
        }

        ///Character 3
        if(ActiveChar[2]==1)
        {
            if(DisableMovDown[2]==0)
            {//se non in collisione sopra(in salto o caduta libera)
                VelocityY[2] += Gravity;
                if(VelocityY[2]>=14) VelocityY[2]=14;
                cuby[2]+=VelocityY[2];
            }
        }

        if(add==1)
        {//se up
            if(DisableMov[3]==1)
            {//se sulla collisione sopra
                VelocityY[0]=-16;
				DisableMov[3]=0;///rimuove collisione sopra
				VelocityY[0] += Gravity;
				cuby[0]+=VelocityY[0];
                DrawJump=1;
            }
            add=0;//disattiva rientrata
        }

        if(minus==1)
        {
            if(VelocityY[0] < -8.0) VelocityY[0] = -8.0;//velocityY
            minus=0;
        }

        //TouchReturned=ReadTouch2(cuby[0], cubx[0]);
        TouchReturned=ReadRfModule();

        if(TouchReturned==EXIT) break;
        ///Temporaneo
        if(TouchReturned==Up)
        {//if right
            add=1;
        }

        //if(PORTDbits.RD0==0){//if right
        if(TouchReturned==Right)
        {//if right
            if(DisableMov[1]==0) cubx[0]+=inc;
            add=0;
            DrawDx=1;
        }
        
        if(TouchReturned==Left)
        {//if left
            if(DisableMov[2]==0) cubx[0]-=inc;
            add=0;
            DrawSx=1;
        }

        TouchReturned=0;

        if(PORTDbits.RD3==0)
        {//down
            if(DisableMov[3]==0) cuby[0]+=inc;
        }

        if(ActiveChar[1]==1) cubx[1]+=VelocityX[1];///incrementa posizione in x automatica(nessun controllo attiva/disattiva)
        if(ActiveChar[2]==1) cubx[2]+=VelocityX[2];

        for(i=0; i<4;i++)
        {
            DisableMov[i]=0;
            DisableMovUp[i]=0;
            DisableMovDown[i]=0;
            DisableMovLeft[i]=0;
            DisableMovRight[i]=0;
        }
	
        for(a=0; a<3;a++) //numero di elementi in movimento
        {
            for(i=0; i<o;i++) //numero di cubi da controllare
            {
                if(VelocityY[a]<=0)/// durante il salto
                {
                    if(((cubx[a]>=xfix[i])&&(cubx[a]<=xfix[i]+15))&&((cuby[a]>=yfix[i])&&(cuby[a]<=(yfix[i]+15)))) ///se l'angolo in alto a sinistra del personaggio entra nel cubo
                    {
                        OverLap=1;
                        //sprintf(TextBuffer,"DOWN X:%03d Y:%03d",dx,dy);
                        //LCD_Text57(50,42,TextBuffer,1,BLACK,WHITE);
                        cuby[a]=yfix[i]+16;//la posizione del personaggio è ugale a quella del cubo piu 16(1 pixel sotto al cubo)
                        VelocityY[a]=2;///inverte la velocià(incomincia la discesa)

                        /////intercetta quale cubo colpito
                        if(p==255) p=i;

                    }

                    if((((cubx[a]+15)>=xfix[i])&&((cubx[a]+15)<=(xfix[i]+15)))&&((cuby[a]>=yfix[i])&&(cuby[a]<=(yfix[i]+15))))///se l'angolo in alto a destro del personaggio entra nel cubo
                    {
                        OverLap=1;
                        //sprintf(TextBuffer,"DOWN X:%03d Y:%03d",dx,dy);
                        //LCD_Text57(50,42,TextBuffer,1,BLACK,WHITE);
                        cuby[a]=yfix[i]+16;
                        VelocityY[a]=2;
                        if(p==255) p=i;
                    }
                }

                if(VelocityY[a]>0)/// se il personaggio è in discesa
                {
                    ///collisione con il nemico 
                    if((ActiveChar[a]==1)&&(a>0))
                    {
                        if(DisableMov[3]==0)
                        {
                            if(((cubx[0]>=cubx[a])&&(cubx[0]<=(cubx[a]+15)))&&(((cuby[0]+15)>=cuby[a])&&((cuby[0]+15)<=(cuby[a]+15))))////nemico muore
                            {
                                OverLap=1;
                                DisableMov[3]=1;//disattiva discesa
                                DisableMovDown[0]=1;
                                cuby[0]=cuby[1]-16;//la posizione del personaggio è ugale a quella del cubo meno 16(16 pixel sopra al cubo)
                                DrawJump=0;///imposta posizione standby del personaggio
                                add=1;///fa il salto
                                ActiveChar[a]=2;///dead from mario

                            }
                            if((((cubx[0]+15)>=cubx[a])&&((cubx[0]+15)<=(cubx[a]+15)))&&(((cuby[0]+15)>=cuby[a])&&((cuby[0]+15)<=(cuby[a]+15))))//nemico muore
                            {
                                OverLap=1;
                                DisableMov[3]=1;//disattiva discesa
                                DisableMovDown[0]=1;
                                cuby[0]=cuby[1]-16;//la posizione del personaggio è ugale a quella del cubo meno 16(16 pixel sopra al cubo)
                                DrawJump=0;///imposta posizione standby del personaggio
                                add=1;///fa il salto
                                ActiveChar[a]=2;///dead from mario
                            }
                        }
                        if(DisableMov[3]==1)///se sopra a cubo e collisione con nemico, dead
                        {
                            if(((cubx[0]>=cubx[a])&&(cubx[0]<=(cubx[a]+15)))&&(((cuby[0]+15)>=cuby[a])&&((cuby[0]+15)<=(cuby[a]+15))))///Angolo in basso a sinistra
                            {
                                Life++;
                                sprintf(TextBuffer,"Game Over! %03d",Life);
                                LCD_Text57Land(10,5,TextBuffer,1,WHITE,BLACK);

                                OverLap=1;
                                DisableMov[3]=0;// discesa
                                DisableMovDown[0]=0;
                                cuby[0]=40;
                                cubx[0]=140;
                                DrawJump=0;///imposta posizione standby del personaggio
                                //add=1;///fa il salto
                            }
                            if((((cubx[0]+15)>=cubx[a])&&((cubx[0]+15)<=(cubx[a]+15)))&&(((cuby[0]+15)>=cuby[a])&&((cuby[0]+15)<=(cuby[a]+15))))///Angolo in basso a destra
                            {
                                Life++;
                                sprintf(TextBuffer,"Game Over! %03d",Life);
                                LCD_Text57Land(10,5,TextBuffer,1,WHITE,BLACK);

                                OverLap=1;
                                DisableMov[3]=0;// discesa
                                DisableMovDown[0]=0;
                                cuby[0]=40;
                                cubx[0]=140;
                                DrawJump=0;///imposta posizione standby del personaggio
                                //add=1;///fa il salto
                            }
                        }
                    }
/*
                    if(ActiveChar[2]==1)
                    {
                        if((DisableMov[3]==0)&&(a>0))
                        {
                            if(((cubx[0]>=cubx[2])&&(cubx[0]<=(cubx[2]+15)))&&(((cuby[0]+15)>=cuby[2])&&((cuby[0]+15)<=(cuby[2]+15))))
                            {
                                OverLap=1;
                                DisableMov[3]=1;//disattiva discesa
                                DisableMovDown[0]=1;
                                cuby[0]=cuby[1]-16;//la posizione del personaggio è ugale a quella del cubo meno 16(16 pixel sopra al cubo)
                                DrawJump=0;///imposta posizione standby del personaggio
                                add=1;///fa il salto
                                ActiveChar[2]=2;
                            }
                            if((((cubx[0]+15)>=cubx[2])&&((cubx[0]+15)<=(cubx[2]+15)))&&(((cuby[0]+15)>=cuby[2])&&((cuby[0]+15)<=(cuby[2]+15))))
                            {
                                OverLap=1;
                                DisableMov[3]=1;//disattiva discesa
                                DisableMovDown[0]=1;
                                    cuby[0]=cuby[1]-16;//la posizione del personaggio è ugale a quella del cubo meno 16(16 pixel sopra al cubo)
                                DrawJump=0;///imposta posizione standby del personaggio
                                add=1;///fa il salto
                                ActiveChar[2]=2;
                            }
                        }

                        if((DisableMov[3]==1)&&(a>0))///se sopra a cubo e collisione con nemico, dead
                        {
                            if(((cubx[0]>=cubx[2])&&(cubx[0]<=(cubx[2]+15)))&&(((cuby[0]+15)>=cuby[2])&&((cuby[0]+15)<=(cuby[2]+15))))///Angolo in basso a sinistra
                            {
                                Life++;
                                sprintf(TextBuffer,"Game Over! %03d",Life);
                                LCD_Text57Land(40,20,TextBuffer,1,BLACK,WHITE);

                                OverLap=1;
                                DisableMov[3]=0;// discesa
                                DisableMovDown[0]=0;
                                cuby[0]=40;
                                cubx[0]=140;
                                DrawJump=0;///imposta posizione standby del personaggio
                                //add=1;///fa il salto
                            }
                            if((((cubx[0]+15)>=cubx[2])&&((cubx[0]+15)<=(cubx[2]+15)))&&(((cuby[0]+15)>=cuby[2])&&((cuby[0]+15)<=(cuby[2]+15))))///Angolo in basso a destra
                            {
                                Life++;
                                sprintf(TextBuffer,"Game Over! %03d",Life);
                                LCD_Text57Land(40,20,TextBuffer,1,BLACK,WHITE);

                                OverLap=1;
                                DisableMov[3]=0;// discesa
                                DisableMovDown[0]=0;
                                cuby[0]=40;
                                cubx[0]=140;
                                DrawJump=0;///imposta posizione standby del personaggio
                                //add=1;///fa il salto
                            }
                        }
                    }*/

                    if(((cubx[a]>=xfix[i])&&(cubx[a]<=(xfix[i]+15)))&&(((cuby[a]+15)>=yfix[i])&&((cuby[a]+15)<=(yfix[i]+15))))///se l'angolo in basso a sinistra del personaggio entra nel cubo
                    {
                        OverLap=1;
                        //sprintf(TextBuffer,"UP X:%03d Y:%03d",dx,dy);
                        //LCD_Text57(50,12,TextBuffer,1,BLACK,WHITE);
                        DisableMov[3]=1;//disattiva discesa
                        DisableMovDown[a]=1;
                        cuby[a]=yfix[i]-16;//la posizione del personaggio è ugale a quella del cubo meno 16(16 pixel sopra al cubo)
                        if(a==0) DrawJump=0;///imposta posizione stanby del personaggio
                    }

                    if((((cubx[a]+15)>=xfix[i])&&((cubx[a]+15)<=(xfix[i]+15)))&&(((cuby[a]+15)>=yfix[i])&&((cuby[a]+15)<=(yfix[i]+15))))///se l'angolo in basso a destra del personaggio entra nel cubo
                    {//collisione sopra oggetto
                        OverLap=1;
                        //sprintf(TextBuffer,"UP X:%03d Y:%03d",dx,dy);
                        //LCD_Text57(50,12,TextBuffer,1,BLACK,WHITE);
                        DisableMov[3]=1;//disattiva discesa
                        DisableMovDown[a]=1;
                        if(a==0) DrawJump=0;
                        cuby[a]=yfix[i]-16;
                    }
                }

                if(!OverLap)
                {
                    dx=(signed short int)(xfix[i])-cubx[a];
                    dy=(signed short int)(yfix[i])-cuby[a];
                    if ((abs(dx) <= w) && (abs(dy) <= h))
                    {
                        wy=w*dy;
                        hx=h*dx;
                        if(wy > hx)
                        {
                            if(wy > -hx)
                            {///collisione sopra oggetto
                                //sprintf(TextBuffer,"UP X:%03d Y:%03d",dx,dy);
				//LCD_Text57(50,12,TextBuffer,1,BLACK,WHITE);
				if(a>0)DisableMovDown[a]=1;
				else 
                                {
                                    DisableMov[3]=1;//disattiva discesa
                                    DrawJump=0;
                                }
				cuby[a]=yfix[i]-16;
                            }
                            else
                            {///collisione a destra
                                if((dx==-16)&&(dy==16))
                                {/*EdgeColl[0]=1; EdgeColl[1]=1; EdgeColl[2]=1; EdgeColl[3]=1;*/}///non fa niente
                                else
                                {
                                    //sprintf(TextBuffer,"RIGHT X:%03d Y:%03d",dx,dy);
                                    //LCD_Text57(50,22,TextBuffer,1,BLACK,WHITE);
                                    if((dx==-14)&&((dy>=-6)&&(dy<=12)))
                                    {
                                        if(a>0) VelocityX[a]*=-1;
										else
										{
                                            cubx[a]+=inc;
                                            DisableMov[2]=1;
										}
                                    }///se sull'angolo torna indietro: ci arriva solo con un movimento obliquo(y+x).
                                    else
                                    {
                                        if(a>0) VelocityX[a]*=-1;
										else DisableMov[2]=1; 				
                                    }
                                    //if(dx<=-8){
                                    //	DisableMov[0]=1;
                                    //	cuby=yfix[i]+16;
                                    //	VelocityY=2;
                                    //}
                                }
                            }
                        }
                        else
                        {///collisione a sinistra
                            if(wy> -hx)
                            {
                                if((dx==16)&&(dy==16)) {/*EdgeColl[0]=1; EdgeColl[1]=1; EdgeColl[2]=1; if(DownOk==0)EdgeColl[3]=1;*/}///non fa niente
                                else
                                {
                                    //sprintf(TextBuffer,"LEFT X:%03d Y:%03d",dx,dy);
                                    //LCD_Text57(50,32,TextBuffer,1,BLACK,WHITE);
                                    if((dx<=14)&&((dy>=-6)&&(dy<=12)))
                                    {
                                        if(a>0) VelocityX[a]*=-1;
										else
                                        {
                                            cubx[a]-=inc;
                                            DisableMov[1]=1;
                                        }
                                    }///se sull'angolo torna indietro: ci arriva solo con un movimento obliquo(y+x).
                                    else
                                    {
                                        if(a>0) VelocityX[a]*=-1;
										else DisableMov[1]=1;
                                    }
                                    //if(dx<=13){
                                    //	DisableMov[0]=1;
                                    //	cuby=yfix[i]+16;
                                    //	VelocityY=2;
                                    //}
                                }
                            }
                            else
                            {///collisione sotto
                                if(((dx==-16)&&(dy==-16))||((dx==16)&&(dy==-16))) {/*EdgeColl[0]=1; EdgeColl[1]=1; EdgeColl[2]=1; EdgeColl[3]=1;*/}///non fa niente
                                else
                                {
                                    //sprintf(TextBuffer,"DOWN X:%03d Y:%03d",dx,dy);
                                    //LCD_Text57(50,42,TextBuffer,1,BLACK,WHITE);
                                    if(((dx==14)&&(dy==-14))||((dx==-14)&&(dy==-14)))
                                    {
                                        if(dx==-14)
                                        {
                                            if(a>0) VelocityX[a]=-1;
                                            else
                                            {
                                                cubx[0]+=inc;
												DisableMov[2]=1; 
                                            }
                                        }
                                        else
                                        {
                                            if(a>0) VelocityX[a]*=-1;
                                            else
                                            {
                                                cubx[0]-=inc;
												DisableMov[1]=1; 
                                            }
                                        }
                                    }///se sull'angolo torna indietro: ci arriva solo con un movimento obliquo(y+x).
                                    else
                                    {
                                        if(a>0) VelocityX[a]*=-1;
										else DisableMov[0]=1;	///disattiva salita
                                    }
                                    cuby[a]=yfix[i]+16;
                                    VelocityY[a]=2;
                                }
                            }
                        }
                    }
                }
                OverLap=0;
            }
        }

        //Carica nuovo livello da microsd..
        if((cubx[0]>305)||(cubx[0]<3))
        {
            wFSchdir ((unsigned short int *)&smapp[0]);
            if(cubx[0]<3)
            {
                Level=Level-0x01;
                cubx[0]=300;
                CubXOld[0]=300;
            }
            else
            {
                Level=Level+0x01;
                cubx[0]=4;
                CubXOld[0]=4;
            }
            Leveln[10]=Level;

            Punta = wFSfopen ((unsigned short int *)Leveln, "r");
            if(Punta==NULL)
            {
				sprintf(TextBuffer,"File non trovato!");
				LCD_Rect(20,20,110,40,1,WHITE);
				LCD_Text57Land(20,30,TextBuffer,1,BLACK,NONE);
            }
            else
            {
                BufCount=0;

                FSfread (LevelBuffer, 21, 1, Punta);
               // strcpy(TextBuffer,LevelBuffer);
                //LCD_Text57Land(20,10,TextBuffer,1,BLACK,NONE);

                //while(LevelBuffer[BufCount]!=0x7c) BufCount++;//si porta alla corretta posizione
                //BufCount++;
                FSfread (LevelBuffer, 63, 1, Punta);
                BufCount++;

                for(Ba=0; Ba<14; Ba++)
                {
                    for(Bb=0; Bb<20; Bb++)
                    {
                        LevelBuffer[BufCount]-=0x30;
                        LevelBuffer[BufCount]*=10;
                        LevelBuffer[BufCount+1]-=0x30;

                        TypeBrick[Ba][Bb]=(LevelBuffer[BufCount]+LevelBuffer[BufCount+1]);
                        BufCount+=3;
                        //BufCount++;
                        if(LevelBuffer[BufCount]==0x0d)
                        {
                            FSfread (LevelBuffer, 63, 1, Punta);
                            BufCount=1;
                        }
                    }
                }
                FSfclose (Punta);
            }
       /*     Xcursor=230;
            Ycursor=5;
            for(Bb=0; Bb<14; Bb++){
            for(Ba=0; Ba<20; Ba++){
                sprintf(TextBuffer,"%02d",TypeBrick[Bb][Ba]);
                LCD_Text57Land(Xcursor,Ycursor,TextBuffer,1,BLACK,AZZURRO);
            }
            Xcursor-=8;
            
            }*/

            //TypeBrick[4][9]=0;
            //TypeBrick[4][10]=0;
            //TypeBrick[6][10]=3;
           
            goto SMStart;
        }

        if(DrawJump==1) CharacterN=1;//Salto
        if(DrawDx==1) Direction=1;
        if(DrawSx==1) Direction=0;
        if((DrawSx==0)&&(DrawDx==0)&&(DrawJump==0)) CharacterN=2;
        if(((DrawDx==1)||(DrawSx==1))&&(DrawJump==0))
        {
            CharacterN++;
            if(CharacterN==3) CharacterN=0;
        }

        DrawDx=0;
        DrawSx=0;
        DrawJump=0;

        if(Character2N==3) Character2N=4;
        else Character2N=3;

        ////Ciclo dead nemico
        if(ActiveChar[1]==2)
        {
            DrawSM(CubXOld[1],CubYOld[1],3,0,1);///NEMICO MORTO
            DrawSM(cubx[1],cuby[1],3,0,2);///NEMICO MORTO
            DeadTime++;
            if(DeadTime==5)
            {
                DeadTime=0;
                ActiveChar[1]=0;
                DrawSM(cubx[1],cuby[1],3,0,1);///NEMICO MORTO
            }     
        }

        if(ActiveChar[2]==2)
        {
            DrawSM(CubXOld[2],CubYOld[2],3,0,1);///NEMICO MORTO
            DrawSM(cubx[2],cuby[2],3,0,2);///NEMICO MORTO
            DeadTime++;
            if(DeadTime==5)
            {
                DeadTime=0;
                ActiveChar[2]=0;
                DrawSM(cubx[2],cuby[2],3,0,1);///NEMICO MORTO
            }
        }
        ////fine ciclo dead nemico

        DrawSM(CubXOld[0],CubYOld[0],CharacterN,Direction,1);
        if(ActiveChar[1]==1) DrawSM(CubXOld[1],CubYOld[1],Character2N,Direction,1);
        if(ActiveChar[2]==1) DrawSM(CubXOld[2],CubYOld[2],Character2N,Direction,1);

        //LCD_Rect(CubXOld[1],CubYOld[1],CubXOld[1]+15,CubYOld[1]+15,0,AZZURRO);
        //LCD_Rect(CubXOld[2],CubYOld[2],CubXOld[2]+15,CubYOld[2]+15,0,AZZURRO);

        DrawSM(cubx[0],cuby[0],CharacterN,Direction,0);
        if(ActiveChar[1]==1) DrawSM(cubx[1],cuby[1],Character2N,0,0);
        if(ActiveChar[2]==1) DrawSM(cubx[2],cuby[2],Character2N,0,0);

        ///Aggiorna cubi (bonus) dopo collisione
        if(p!=255)
        {
            if(bricktype[p]==2)
            {
                bricktype[p]=3;
                Rota90T=xfix[p];
                Rota90X=yfix[p];
                Rota90Y=Rota90T;
                Rota90X=239-Rota90X;
                DrawBrick(Rota90X,Rota90Y,bricktype[p]);
                Bonus+=10;
                sprintf(TextBuffer,"Score: %03d",Bonus);
                LCD_Text57Land(230,200,TextBuffer,1,BLACK,AZZURRO);

                //Update level array
                for(Ba=0; Ba<20; Ba++) if(xfix[p]==xload[Ba]) break;
                for(Bb=0; Bb<14; Bb++) if(yfix[p]==yload[Bb]) break;

                TypeBrick[Bb][Ba]=3;

            }
        p=255;
        }       

        //LCD_Rect(cubx[1],cuby[1],cubx[1]+15,cuby[1]+15,0,RED);
        //LCD_Rect(cubx[2],cuby[2],cubx[2]+15,cuby[2]+15,0,GREEN);
        //LCD_Rect(cubx[0],cuby[0],cubx[0]+15,cuby[0]+15,0,BLUE);

        for(i=0; i<3; i++)
        {
            CubXOld[i]=cubx[i];
            CubYOld[i]=cuby[i];
        }

        //debug
       // sprintf(TextBuffer,"%03d,%d",VelocityY[0],DisableMov[3]);
       // LCD_Text57Land(20,20,TextBuffer,1,BLACK,WHITE);

        DelayMs(25);
    }
}

void DrawBrick(unsigned short int x, unsigned short int y, unsigned char brick)
{
    unsigned short int i=0;
    signed char a=0,b=0;

    /*i=x;
    x=y;
    y=i;

    x=239-x;
    i=0;
*/
    brick=brick-1;
    
    for(b=0; b<16; b++)
        {
            for(a=0; a<16; a++)
            {
                if(Cubix[brick][i]==0xfe) LCD_Pixel(x-b,y+a,RGB16(0xea,0x9e,0x22));
				if(Cubix[brick][i]==0xff) LCD_Pixel(x-b,y+a,RGB16(0xff,0xc0,0xcb));//Pink
				if(Cubix[brick][i]==0x24) LCD_Pixel(x-b,y+a,MAROON);
				if(Cubix[brick][i]==0x00) LCD_Pixel(x-b,y+a,BLACK);
				if(Cubix[brick][i]==0x0b) LCD_Pixel(x-b,y+a,AZZURRO);
				if(Cubix[brick][i]==0x0c) LCD_Pixel(x-b,y+a,GREEN);
				if(Cubix[brick][i]==0x1c) LCD_Pixel(x-b,y+a,RGB16(0x00,0x80,0x00));///verde scuro
				
				i++;
            }
        }

}

void DrawSM(unsigned short int x, unsigned short int y, unsigned char SMn, _Bool ForBack, char ClearSM)
{
    unsigned short int i=0;
    signed char a=0,b=0;

    i=x;
    x=y;
    y=i;
    x=239-x;
    i=0;

    if(ClearSM==0)
	{
		if (ForBack)
		{
			for(b=0; b<16; b++)
			{
				for(a=0; a<16; a++)
				{
					//if(mario[SMn][i]==0xff) LCD_Pixel(x+a,y+b,WHITE);
					/*if(Character[SMn][i]==0x03) LCD_Pixel(x+a,y+b,BLUE);
					if(Character[SMn][i]==0xe3) LCD_Pixel(x+a,y+b,RGB16(0xff,0xc0,0xcb));//Pink
					if(Character[SMn][i]==0xe0) LCD_Pixel(x+a,y+b,RED);
					if(Character[SMn][i]==0x24) LCD_Pixel(x+a,y+b,MAROON);//Brown RGB16(0xa5,0x2a,0x2a)
					if(Character[SMn][i]==0x00) LCD_Pixel(x+a,y+b,BLACK);
					*/
					if(Character[SMn][i]==0x03) LCD_Pixel(x-b,y+a,BLUE);
					if(Character[SMn][i]==0xe3) LCD_Pixel(x-b,y+a,RGB16(0xff,0xc0,0xcb));//Pink 0xfe19
					if(Character[SMn][i]==0xe0) LCD_Pixel(x-b,y+a,RED);
					if(Character[SMn][i]==0x24) LCD_Pixel(x-b,y+a,MAROON);//Brown RGB16(0xa5,0x2a,0x2a)
					if(Character[SMn][i]==0x00) LCD_Pixel(x-b,y+a,BLACK);
					i++;
				}
			}
		}
		else
		{
			i=15;
			for(b=0; b<16; b++)
			{
				for(a=0; a<16; a++)
				{
					//if(mario[SMn][i]==0xff) LCD_Pixel(x+a,y+b,WHITE);
					/*if(Character[SMn][i]==0x03) LCD_Pixel(x+a,y+b,BLUE);
					if(Character[SMn][i]==0xe3) LCD_Pixel(x+a,y+b,RGB16(0xff,0xc0,0xcb));//Pink
					if(Character[SMn][i]==0xe0) LCD_Pixel(x+a,y+b,RED);
					if(Character[SMn][i]==0x24) LCD_Pixel(x+a,y+b,MAROON);//Brown RGB16(0xa5,0x2a,0x2a)
					if(Character[SMn][i]==0x00) LCD_Pixel(x+a,y+b,BLACK);
					*/
					if(Character[SMn][i]==0x03) LCD_Pixel(x-b,y+a,BLUE);
					if(Character[SMn][i]==0xe3) LCD_Pixel(x-b,y+a,RGB16(0xff,0xc0,0xcb));//Pink
					if(Character[SMn][i]==0xe0) LCD_Pixel(x-b,y+a,RED);
					if(Character[SMn][i]==0x24) LCD_Pixel(x-b,y+a,MAROON);//Brown RGB16(0xa5,0x2a,0x2a)
					if(Character[SMn][i]==0x00) LCD_Pixel(x-b,y+a,BLACK);
					i--;
				}
				i=i+32;
			}
		}
    }

    if(ClearSM==1)
    {
        //LCD_FastRect(x,y,x+15,y+15,AZZURRO);
        LCD_FastRect(x-15,y,x,y+15,AZZURRO);
    }

    if(ClearSM==2)///disegna capovolto (dead)
    {
        i=255;
        for(b=0; b<16; b++)
        {
            for(a=0; a<16; a++)
            {
                if(Character[SMn][i]==0x03) LCD_Pixel(x-b,y+a,BLUE);
				if(Character[SMn][i]==0xe3) LCD_Pixel(x-b,y+a,RGB16(0xff,0xc0,0xcb));//Pink
				if(Character[SMn][i]==0xe0) LCD_Pixel(x-b,y+a,RED);
				if(Character[SMn][i]==0x24) LCD_Pixel(x-b,y+a,MAROON);//Brown RGB16(0xa5,0x2a,0x2a)
				if(Character[SMn][i]==0x00) LCD_Pixel(x-b,y+a,BLACK);
				i--;
            }
        }
    }
}

unsigned char ReadTouch2( unsigned short int ypos, unsigned short int xpos)
{
	if(PORTDbits.RD14==0)
	{
		unsigned short int x,y,i;

                
                ypos=239-ypos;
		
		read();
		x=getX();
		y=getY();
		x=(unsigned short int)((((float)6.01/(float)233.01)*(float)x)+(float)x);
        y=(unsigned short int)((((float)10.01/(float)313.01)*(float)y)+(float)y);

        //LCD_FastRect(1,1,ypos,xpos,RED);
        //LCD_FastRect(1,xpos,ypos,319,GREEN);

        //LCD_FastRect(ypos,xpos-40,239,xpos+56,BLUE);

    if (((1<=xpos)&&(xpos<=40))&&((1<=y)&&(y<=40))&&((1<=x)&&(x<=xpos))) return 1;
    else if(((1<=x)&&(x<=ypos))&&(y<xpos)) return 1; //Left

    if (((280<=xpos)&&(xpos<=319))&&((280<=y)&&(y<=319))&&((xpos<=x)&&(x<=319))) return 2;
    else if(((1<=x)&&(x<=ypos))&&(y>xpos)) return 2; //Right
        
        
        
       // if(((1<=x)&&(x<=ypos))&&(y<xpos)) return 1; //Left

        //if(((1<=x)&&(x<=ypos))&&(y>xpos)) return 2; //Right


        /*if ((40<=xpos)&&(xpos<=280))
        {
            if(((1<=x)&&(x<=239))&&((1<=y)&&(y<=(xpos)))) return 1; //Left
        }
        else if(((1<=x)&&(x<=239))&&((1<=y)&&(y<=(39)))) return 1; //Left

        if((40<=(xpos+16))&&((xpos+16)<=280))
        {
            if(((1<=x)&&(x<=239))&&(((xpos+16)<=y)&&(y<=319))) return 2; //Right
        }
        else if(((1<=x)&&(x<=239))&&(((281)<=y)&&(y<=319))) return 2; //Right
        
        if ((51<=xpos)&&(xpos<=254))
        {
            if((((ypos)<=x)&&(x<=239))&&((((xpos-50))<=y)&&(y<=(xpos+66)))) return 3;//Up
        }
        else if(((ypos<=x)&&(x<=239))&&(((1<=y)&&(y<=319)))) return 3;//Up

*/

    if(((ypos<=x)&&(x<=239))&&(((1<=y)&&(y<=319)))) return 3;//Up
    
		//if(((1<=x)&&(x<=ypos))&&((1<=y)&&(y<=(xpos)))) return 1; //Left
		//if(((1<=x)&&(x<=ypos))&&(((xpos+4)<=y)&&(y<=319))) return 2; //Right
        if(((5<=x)&&(x<=25))&&((145<=y)&&(y<=165))) return 4; //Down
        //if(((5<=x)&&(x<=25))&&((285<=y)&&(y<=305))) return 5;//OK
        //if(((ypos<=x)&&(x<=239))&&(((1<=y)&&(y<=319)))) return 3;//Up
        if(((1<=x)&&(x<=15))&&((270<=y)&&(y<=319))) return 6;//EXIT
	}
    return 0;
}

void DrawNuvola(unsigned char x, unsigned short int y)
{
	unsigned char a=0,b=0;
	unsigned short int i=0;
	
	for(b=0; b<24; b++)
	{
		for(a=0; a<32; a++)
		{
			if(Nuvola[i]==0xff) LCD_Pixel(x-b,y+a,WHITE);//Pink
			if(Nuvola[i]==0x03) LCD_Pixel(x-b,y+a,BLUE);//Brown
			if(Nuvola[i]==0x00) LCD_Pixel(x-b,y+a,BLACK);
			i++;
		}
	}
}

unsigned char ReadRfModule(void)
{
    unsigned char c=0;
    char testobuff[20];

   

    c=RF_CS_IRQ;

        if(c==1)
        {
            IFS0bits.INT2IF=1;
        }


            if(ChkSumLed == 1)
            {
                ChkSumLed=0;
                sprintf(testobuff,"Push: %02x",rfData.buffer[0]);
                LCD_Text57Land(230,200,testobuff,1,BLACK,RED);
                sprintf(testobuff,"Push: %02x",rfData.buffer[1]);
                LCD_Text57Land(210,200,testobuff,1,BLACK,RED);
                if(rfData.buffer[0]==0xab) return rfData.buffer[1];

            }
            else return 0;
}
